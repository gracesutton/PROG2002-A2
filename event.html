<!DOCTYPE html>
<html>

<head>
  <title>Event Details</title>
  <link rel="stylesheet" href="style.css" />
</head>
<script>
  // javascript can go here
</script>

<body>
  <!-- Navigation Menu -->
  <header class="navbar">
    <h1>Gold Coast Charity Connect</h1>
    <a href="/"><button>Home</button></a>
    <a href="/search"><button>Search</button></a>
  </header>

  <section id="event-page">
    <div id="leftColumn">
      <div id="eventDetailsDiv"></div>

        <button id="registerButton" onclick="alert('This feature is currently under construction.');">Register</button>


      <!-- <button id="registerButton" onclick="document.getElementById('eventRegistrationDiv').style.display='block'; this.style.display='none';">Register for this event</button>

      <div id="eventRegistrationDiv" style="display:none;">
        <form id="eventRegistrationForm" onsubmit="registerForEvent(); return false;">
          <h3>Register for this event</h3>
          <label for="fullName">Full Name:</label>
          <input type="text" id="fullName" required>
          <br><br>
          <label for="email">Email:</label>
          <input type="email" id="email" required>
          <br><br>
          <button type="submit">Register</button>
        </form>
      </div> -->
    </div>

    <div id="rightColumn">
      <div id="eventImageDiv">
        <p>Image here</p>
        <!-- <img src="header.jpeg" width="200"> -->
      </div>
      <div id="goal-progress-div"></div>
      <div id="orgDetailsDiv"></div>
    </div>
  </section>

  <!-- <section id="event-details-box">
    <div id="eventDetailsDiv"></div>
    <div id="orgDetailsDiv"></div>
    <div id="goal-progress-div"></div>
  </section>

  <br>

  <button id="registerButton" onclick="document.getElementById('eventRegistrationDiv').style.display='block'; this.style.display='none';">Register for this event</button>

  <div id="eventRegistrationDiv" style="display:none;">
    <form id="eventRegistrationForm" onsubmit="registerForEvent(); return false;">
      
      <h3>Register for this event</h3>
      <label for="fullName">Full Name:</label>
      <input type="text" id="fullName" required>

      <label for="email">Email:</label>
      <input type="email" id="email" required>

      <button type="submit">Register</button>
    </form>
  </div>

  <br><br> -->


  <img src="header.jpeg" width="100%">

  <script>

    // Get the event ID from the query string (e.g. ?id=1)
    const params = new URLSearchParams(window.location.search);
    const eventID = params.get('id');

    if (!eventID) {
      document.getElementById('eventDetailsDiv').innerHTML = "<p>No event selected.</p>";
    } else {


    // Fetch upcoming events
    fetch('http://localhost:8080/api/events/'+eventID)
      .then(response => response.json())
      .then(data => {

        if (!data || data.length === 0) {
          document.getElementById('eventDetailsDiv').innerHTML = "<p>Event not found.</p>";
          return;
        }

        const event = Array.isArray(data) ? data[0] : data;

        const eventDetailsDiv = document.getElementById('eventDetailsDiv');
        const orgDetailsDiv = document.getElementById('orgDetailsDiv');
        const goalProgressDiv = document.getElementById('goal-progress-div');

        eventDetailsDiv.innerHTML = `
          <h2>${event.EventName}</h2>
          <p>${event.Description}</p>
          <p>Date: ${new Date(event.EventDate).toLocaleDateString()}</p>
          <p>Location: ${event.Location}</p>
          <p>Category: ${event.CategoryName}</p>
          <p>Ticket Price: ${event.TicketPrice}</p>
        `;

        orgDetailsDiv.innerHTML = `
          <h4>Organiser Details</h4>
          <p>Name: ${event.OrganisationName}</p>
          <p>Description: ${event.OrganisationDescription}</p>
          <p>Website: ${event.Website}</p>
          <p>Contact: ${event.Phone}</p>
        `;

        goalProgressDiv.innerHTML = `
          <h4>Goal Progress</h4>
          <p>Goal Amount: ${event.GoalAmount}</p>
          <p>Current Progress: ${event.CurrentProgress}</p>
          <p>${((event.CurrentProgress / event.GoalAmount) * 100).toFixed(2)}% of goal reached</p>
        `;
        })
      .catch(error => {
        console.error('Error fetching events:', error);
        document.getElementById('eventDetailsDiv').innerHTML = "Failed to load event";
      });
    }

  </script>

</body>

</html>